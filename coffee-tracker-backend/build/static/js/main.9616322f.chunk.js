(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t){},12:function(e,t,a){},180:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(39),c=a.n(r),i=(a(92),a(2)),o=a(3),s=a(6),u=a(5),d=a(7),h=a(86),m=a(182),p=a(185),f=(a(12),function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){for(var e=this,t=[],a=0;a<this.props.purchased;a++)t.push("mug"+a);return l.a.createElement("ul",{className:"coffeeMug"},t.map(function(t){return l.a.createElement("img",{src:"./coffee.ico",alt:"icon of a coffee mug",width:"50",height:"50",key:e.props.name+t})}))}}]),t}(n.Component)),g=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=[];return this.props.data.forEach(function(t){var a=e.find(function(e){return e.name===t.name});void 0!==a?a.purchased++:e.push({name:t.name,purchased:1})}),l.a.createElement("div",{className:"bigPadding"},l.a.createElement("ul",null,e.length<=0?"NO DB ENTRIES YET":e.map(function(e){return l.a.createElement("div",{className:"outputBox",key:e.name},l.a.createElement("h2",{className:"coffeeMugName"},e.name,":"),l.a.createElement(f,{purchased:e.purchased,name:e.name}))})))}}]),t}(n.Component),E=a(75),b=a.n(E),v=a(184),k=a(18),y=a.n(k),j=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={id:0,message:null,name:null,coffee:null,datePurchased:null,date:null},a.putDataToDB=function(e,t,n,l,r,c){c.preventDefault();for(var i=a.props.data.map(function(e){return e.id}),o=0;i.includes(o);)++o;y.a.post("/api/putData",{id:o,message:e,name:t,coffee:n,date:l,datePurchased:r})},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("form",{className:"bigPadding"},l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"Add a coffee to the database"),l.a.createElement("input",{type:"text",required:!0,onChange:function(t){return e.setState({coffee:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"Who bought the coffee?"),l.a.createElement("input",{type:"text",autoComplete:"given-name",required:!0,onChange:function(t){return e.setState({name:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"What date was it purchased?"),l.a.createElement("input",{type:"date",onChange:function(t){return e.setState({datePurchased:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"What date was it opened?"),l.a.createElement("input",{type:"date",onChange:function(t){return e.setState({date:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"Add a note about the coffee"),l.a.createElement("input",{type:"text",onChange:function(t){return e.setState({message:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("button",{onClick:function(t){return e.putDataToDB(e.state.message,e.state.name,e.state.coffee,e.state.date,e.state.datePurchased,t)}},l.a.createElement("h4",null,"Add to database"))))}}]),t}(n.Component),O=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={idToDelete:null,idToUpdate:null,objectToUpdate:null},a.deleteFromDB=function(e){var t=null;a.props.data.forEach(function(a){a.id==e&&(t=a._id)}),y.a.delete("/api/deleteData",{data:{id:t}})},a.updateDB=function(e,t,n){var l=null;a.props.data.forEach(function(t){t.id==e&&(l=t._id)}),y.a.post("/api/updateData",{id:l,update:{message:t,date:n}})},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"outputBoxEdit"},l.a.createElement("div",{className:"deleting"},l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"Id of item to delete"),l.a.createElement("input",{type:"text",onChange:function(t){return e.setState({idToDelete:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("button",{onClick:function(){return e.deleteFromDB(e.state.idToDelete)}},l.a.createElement("h4",null,"DELETE")))),l.a.createElement("div",{className:"editing"},l.a.createElement("div",{className:"smallPadding"},l.a.createElement("h4",null,"Id of item to update"),l.a.createElement("input",{type:"text",onChange:function(t){return e.setState({idToUpdate:t.target.value})}}),l.a.createElement("h4",null,"New message"),l.a.createElement("input",{type:"text",onChange:function(t){return e.setState({updateToApply:t.target.value})}}),l.a.createElement("h4",null,"New opened date"),l.a.createElement("input",{type:"date",onChange:function(t){return e.setState({updateToDate:t.target.value})}})),l.a.createElement("div",{className:"smallPadding"},l.a.createElement("button",{onClick:function(){return e.updateDB(e.state.idToUpdate,e.state.updateToApply,e.state.updateToDate)}},l.a.createElement("h4",null,"UPDATE")))))}}]),t}(n.Component),D=a(42),T=a.n(D),N=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return this.props.data&&this.props.data.length<1?l.a.createElement("p",null,"No coffee entered yet"):(this.reversed=this.props.data.reverse(),l.a.createElement("div",{className:"bigPadding"},l.a.createElement("div",{className:"smallPadding"},l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"ID"),l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Date Purchased"),l.a.createElement("th",null,"Date Opened"),l.a.createElement("th",null,"Coffee"),l.a.createElement("th",null,"Note"))),l.a.createElement("tbody",null,this.reversed.map(function(e){return l.a.createElement("tr",{key:e.id},l.a.createElement("td",null,e.id),l.a.createElement("td",null,e.name),l.a.createElement("td",null,"undefined"===typeof e.datePurchased||null===e.datePurchased?l.a.createElement("p",null,"No data"):l.a.createElement(T.a,{format:"DD/MM/YYYY"},e.datePurchased)),l.a.createElement("td",null,"undefined"===typeof e.date||null===e.date?l.a.createElement("p",null,"No data"):l.a.createElement(T.a,{format:"DD/MM/YYYY"},e.date)),l.a.createElement("td",null,e.coffee),l.a.createElement("td",null,e.message))}))))))}}]),t}(n.Component),C=a(11),A=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"login",value:function(){this.props.auth.login()}},{key:"logout",value:function(){this.props.auth.logout()}},{key:"componentDidMount",value:function(){var e=this.props.auth.renewSession;"true"===localStorage.getItem("isLoggedIn")&&e()}},{key:"render",value:function(){var e=this.props.auth.isAuthenticated;return l.a.createElement("div",{className:"bigPadding"},!e()&&l.a.createElement(v.a,{id:"qsLoginBtn",bsStyle:"primary",className:"btn-margin",onClick:this.login.bind(this)},"Log In"),e()&&l.a.createElement(v.a,{id:"qsLogoutBtn",bsStyle:"primary",className:"btn-margin",onClick:this.logout.bind(this)},"Log Out"),l.a.createElement(C.d,null,l.a.createElement(C.b,null,l.a.createElement(C.a,null,l.a.createElement("h3",null,"Add a coffee")),l.a.createElement(C.a,null,l.a.createElement("h3",null,"See all entries")),l.a.createElement(C.a,null,l.a.createElement("h3",null,"Edit an entry"))),l.a.createElement(C.c,null,l.a.createElement(j,{data:this.props.data})),l.a.createElement(C.c,null,l.a.createElement(N,{data:this.props.data})),l.a.createElement(C.c,null,l.a.createElement(O,{data:this.props.data}))))}}]),t}(n.Component),P=Object(p.a)(A),w=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"login",value:function(){this.props.auth.login()}},{key:"render",value:function(){var e=this.props.auth.isAuthenticated;return l.a.createElement("div",null,e()&&l.a.createElement("div",null,l.a.createElement("h4",{className:"bigPadding"},"You are logged in!"),l.a.createElement(P,{data:this.props.data,auth:this.props.auth})),!e()&&l.a.createElement("h4",{className:"bigPadding"},"You are not logged in! Please"," ",l.a.createElement("a",{style:{cursor:"pointer"},onClick:this.login.bind(this)},"Log In")," ","to continue."))}}]),t}(n.Component),S=a(82),I=a.n(S),x=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{style:{position:"absolute",display:"flex",justifyContent:"center",height:"100vh",width:"100vw",top:0,bottom:0,left:0,right:0,backgroundColor:"white"}},l.a.createElement("img",{src:I.a,alt:"loading"}))}}]),t}(n.Component),B=a(83),Y=a.n(B)()(),L=a(84),M={domain:"coffee-tracker.eu.auth0.com",clientId:"Dn61gamMNP0DhK5410emcTc4BholdXGc",callbackUrl:"http://coffee-tracker.eleanormollett.com/callback"},U=function(){function e(){Object(i.a)(this,e),this.auth0=new L.a.WebAuth({domain:M.domain,clientID:M.clientId,redirectUri:M.callbackUrl,responseType:"token id_token",scope:"openid"}),this.login=this.login.bind(this),this.logout=this.logout.bind(this),this.handleAuthentication=this.handleAuthentication.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this),this.getAccessToken=this.getAccessToken.bind(this),this.getIdToken=this.getIdToken.bind(this),this.renewSession=this.renewSession.bind(this)}return Object(o.a)(e,[{key:"login",value:function(){this.auth0.authorize()}},{key:"handleAuthentication",value:function(){var e=this;this.auth0.parseHash(function(t,a){a&&a.accessToken&&a.idToken?e.setSession(a):t&&(Y.replace("/admin"),console.log(t),alert("Error: ".concat(t.error,". Check the console for further details.")))})}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"getIdToken",value:function(){return this.idToken}},{key:"setSession",value:function(e){localStorage.setItem("isLoggedIn","true");var t=1e3*e.expiresIn+(new Date).getTime();this.accessToken=e.accessToken,this.idToken=e.idToken,this.expiresAt=t,Y.replace("/admin")}},{key:"renewSession",value:function(){var e=this;this.auth0.checkSession({},function(t,a){a&&a.accessToken&&a.idToken?e.setSession(a):t&&(e.logout(),console.log(t),alert("Could not get a new token (".concat(t.error,": ").concat(t.error_description,").")))})}},{key:"logout",value:function(){this.accessToken=null,this.idToken=null,this.expiresAt=0,localStorage.removeItem("isLoggedIn"),Y.replace("/admin")}},{key:"isAuthenticated",value:function(){var e=this.expiresAt;return(new Date).getTime()<e}}]),e}(),_=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(a=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(l)))).state={data:[],intervalIsSet:!1,hasInitialData:!1},a.getDataFromDb=function(){fetch("/api/getData").then(function(e){return e.json()}).then(function(e){a.setState({data:e.data,hasInitialData:!0})})},a.auth=new U,a.handleAuthentication=function(e){var t=e.location;/access_token|id_token|error/.test(t.hash)&&a.auth.handleAuthentication()},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getDataFromDb(),this.socket=b.a.connect(),this.socket.on("NewData",this.getDataFromDb)}},{key:"render",value:function(){var e=this;return this.state.hasInitialData?l.a.createElement(h.a,{history:Y},l.a.createElement("div",null,l.a.createElement(m.a,{path:"/",render:function(t){return l.a.createElement(g,{data:e.state.data})}}),l.a.createElement(m.a,{exact:!0,path:"/admin",render:function(t){return l.a.createElement(w,Object.assign({data:e.state.data,auth:e.auth},t))}}),l.a.createElement(m.a,{path:"/callback",render:function(t){return e.handleAuthentication(t),l.a.createElement(x,t)}}))):l.a.createElement("h1",null,"Loading...")}}]),t}(n.Component),F=Object(p.a)(_),q=a(183);c.a.render(l.a.createElement(q.a,null,l.a.createElement(F,null)),document.getElementById("root"))},82:function(e,t,a){e.exports=a.p+"static/media/loading.c5590569.svg"},87:function(e,t,a){e.exports=a(180)},92:function(e,t,a){}},[[87,1,2]]]);
//# sourceMappingURL=main.9616322f.chunk.js.map